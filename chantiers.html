<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Profil Chantier</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f5f5f5;
      padding: 20px;
      margin: 0;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    select {
      display: block;
      width: 100%;
      max-width: 600px;
      margin: 0 auto 20px auto;
      font-size: 16px;
      padding: 10px;
    }

    #profilChantier {
      max-width: 600px;
      margin: 0 auto;
      background: #ffffff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    #profilChantier h2 {
      margin-top: 0;
    }

    .champ {
      margin-bottom: 10px;
    }

    .champ strong {
      display: inline-block;
      width: 140px;
      color: #555;
    }

    .message {
      text-align: center;
      font-style: italic;
      color: #888;
    }
  </style>
</head>
<body>
  <h1>Profil du Chantier</h1>

  <select id="chantierSelect">
    <option value="">Sélectionner un chantier</option>
  </select>

  <div id="profilChantier" style="display: none;">
    <h2 id="nomChantier"></h2>
    <div class="champ"><strong>Adresse :</strong> <span id="adresse"></span></div>
    <div class="champ"><strong>N° de Clef :</strong> <span id="clef"></span></div>
    <div class="champ"><strong>Contact :</strong> <span id="contact"></span></div>
    <div class="champ"><strong>Téléphone :</strong> <span id="tel"></span></div>
    <div class="champ"><strong>Email :</strong> <span id="mail"></span></div>
    <div class="champ"><strong>Syndic :</strong> <span id="syndic"></span></div>
    <div class="champ"><strong>Intervention :</strong> <span id="intervention"></span></div>
    <div class="champ"><strong>Agents :</strong> <span id="agents"></span></div>
    <div class="champ"><strong>Numéros Agents :</strong> <span id="numAgents"></span></div>
    <div class="champ"><strong>Jour de passage :</strong> <span id="jours"></span></div>
    <div class="champ"><strong>Tâches :</strong> <span id="tache"></span></div>
    <div class="champ"><strong>Code :</strong> <span id="code"></span></div>
    <div class="champ"><strong>Code Clef :</strong> <span id="clefCode"></span></div>
  </div>

  <div id="message" class="message"></div>

  <script>
    const chantierSelect = document.getElementById("chantierSelect");
    const profilDiv = document.getElementById("profilChantier");
    const message = document.getElementById("message");

    // Remplir le menu avec la liste des chantiers existants
    function chargerListeChantiers() {
      let chantiers = JSON.parse(localStorage.getItem("listeChantiers")) || [];
      chantiers = [...new Set(chantiers)].filter(c => c && c.trim() !== "");
      chantiers.sort();

      chantierSelect.innerHTML = `<option value="">Sélectionner un chantier</option>`;
      chantiers.forEach(chantier => {
        const option = document.createElement("option");
        option.value = chantier;
        option.textContent = chantier;
        chantierSelect.appendChild(option);
      });
    }

    // Afficher le profil complet d’un chantier
    function afficherProfil(chantier) {
      const profils = JSON.parse(localStorage.getItem("profilChantiers")) || {};
      const profil = profils[chantier];

      if (!profil) {
        profilDiv.style.display = "none";
        message.textContent = "Aucun profil enregistré pour ce chantier.";
        return;
      }

      message.textContent = "";
      document.getElementById("nomChantier").textContent = chantier;
      document.getElementById("adresse").textContent = profil.adresse || "";
      document.getElementById("clef").textContent = profil.clef || "";
      document.getElementById("contact").textContent = profil.contact || "";
      document.getElementById("tel").textContent = profil.tel || "";
      document.getElementById("mail").textContent = profil.mail || "";
      document.getElementById("syndic").textContent = profil.syndic || "";
      document.getElementById("intervention").textContent = profil.intervention || "";
      document.getElementById("agents").textContent = profil.agents || "";
      document.getElementById("numAgents").textContent = profil.numAgents || "";
      document.getElementById("jours").textContent = profil.jours || "";
      document.getElementById("tache").textContent = profil.tache || "";
      document.getElementById("code").textContent = profil.code || "";
      document.getElementById("clefCode").textContent = profil.clefCode || "";

      profilDiv.style.display = "block";
    }

    chantierSelect.addEventListener("change", () => {
      const chantier = chantierSelect.value;
      if (chantier) {
        afficherProfil(chantier);
      } else {
        profilDiv.style.display = "none";
        message.textContent = "";
      }
    });

    chargerListeChantiers();
  </script>
</body>
</html>
